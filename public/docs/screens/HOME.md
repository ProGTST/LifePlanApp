# ホーム画面 仕様書

## 1. 画面基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | home |
| 画面名 | ホーム |
| URL | N/A（SPA。アプリは index.html。初期表示ビューは home） |
| 対象ユーザー | ログイン済みの一般ユーザー全員 |
| 関連画面 | **遷移元**: アプリ起動時のデフォルト、フッター「ホーム」、サイドバー「ホーム」。**遷移先**: フッター・サイドバーから他画面へ。 |

---

## 2. 画面概要

- **目的**: アプリのトップ画面。ログインユーザーのプロフィール（アイコン・表示名）をヘッダーに表示し、必要に応じて Tauri の挨拶機能（greet）を利用する。
- **業務上の位置付け**: ダッシュボード的な入口。収支・スケジュール・マスタ等への導線を提供する。
- **想定利用シナリオ**: ログイン後に最初に表示される画面。ヘッダーで自分を確認し、フッターやサイドバーから目的の画面へ遷移する。

---

## 3. UI構成

### 3.1 画面レイアウト

| エリア | 内容 |
|--------|------|
| ヘッダー | メニューバー（タイトル「ホーム」、データ最新化）、プロフィール領域（アイコン、表示名）。他画面と共通。 |
| 検索エリア | なし |
| 一覧エリア | なし（ホーム固有の一覧はなし。挨拶フォームがある場合はメイン領域に表示） |
| 詳細エリア | 挨拶フォーム（greet-form: greet-input, greet-msg）。Tauri 時は invoke("greet") 用。任意。 |
| フッター | 共通ナビ（ホーム、カレンダー、スケジュール、収支履歴、収支記録、分析、メニュー、設定、戻る） |

### 3.2 入力項目定義

| 項目名 | DB項目 | 型 | 必須 | 制約 | 備考 |
|--------|--------|-----|------|------|------|
| （挨拶入力） | なし | 文字列 | — | — | greet-input。Tauri の greet に渡す名前。DB には保存しない |

※ ヘッダーのプロフィール表示は USER の NAME / COLOR / ICON_PATH を参照するが、本画面では編集しない（プロフィール画面で編集）。

---

## 4. 操作仕様（イベント仕様）

| 操作 | 条件 | 処理内容 | 備考 |
|------|------|----------|------|
| 画面表示 | ビューID が home | registerViewHandler("home") で renderHeaderProfile() を実行。USER.csv から currentUserId に一致する行を取得し、ヘッダーのアイコン・表示名を更新 | |
| データ最新化 | ホーム表示中 | registerRefreshHandler("home") で renderHeaderProfile(true) を実行。cache: reload で USER.csv を再取得してヘッダーを更新 | |
| 挨拶フォーム submit | Tauri 環境等 | invoke("greet", { name: greet-input の値 }) を呼び、結果を greet-msg に表示 | オプション機能 |

---

## 5. 業務ルール

- **表示対象**: ログインユーザー（currentUserId）に一致する USER の1行のみ。NAME, COLOR, ICON_PATH をヘッダーに表示。該当行がなければ表示名は「ユーザー」等のフォールバック。
- **更新は行わない**: 本画面では CSV の更新は行わない。プロフィール変更はプロフィール画面で行う。

---

## 6. データ連携

### 6.1 API仕様

| メソッド | パス | 概要 |
|----------|------|------|
| GET | /api/data/USER.csv | ヘッダー用にユーザー一覧取得。currentUserId に一致する行を表示に使用 |

### 6.2 DB定義（CSV 対応）

| 種別 | テーブル（ファイル） | 備考 |
|------|----------------------|------|
| 使用テーブル | USER | ヘッダー表示用。1行（currentUserId に一致）を参照 |
| 参照テーブル | USER | 同上 |
| 更新対象 | なし | 本画面では更新しない |

---

## 7. 権限制御

- ログイン済みユーザーのみが本画面に到達する（未ログイン時は login.html にリダイレクト）。表示内容は自分自身のプロフィールのみ。

---

## 8. バリデーション仕様

- 挨拶入力は任意。DB に保存しないため、特になし。

---

## 9. エラー仕様

| 項目 | 内容 |
|------|------|
| 表示位置 | USER.csv 取得失敗時はヘッダーを空またはフォールバック表示。エラー表示は特になし |
| メッセージ内容 | 特になし |
| HTTP ステータス | GET が 200 以外のとき fetchCsv は空を返す想定 |

---

## 10. 非機能要件

| 項目 | 内容 |
|------|------|
| レスポンス目標 | 特になし |
| 同時接続数想定 | 特になし |
| ログ出力内容 | 特になし |
